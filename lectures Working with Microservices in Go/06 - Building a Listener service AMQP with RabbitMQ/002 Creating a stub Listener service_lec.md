## Создание заглушки для Listener-сервиса

---

### Шаг 1: Создание нового сервиса и настройка рабочей среды

Для начала создадим новый микросервис, который будет слушателем (Listener). Как обычно, начнем с создания новой папки и добавления её в рабочую область нашего проекта. Для этого откроем файловый менеджер и найдем папку, содержащую все наши сервисы. Внутри этой папки создадим новую директорию, которую назовем `listener-service`.

После этого вернемся в IDE, откроем меню файлов и выберем опцию "Добавить папку в рабочую область" (Add folder to workspace). Далее добавим только что созданную папку `listener-service` в рабочую область. Затем откроем терминал и перейдем в эту папку, чтобы инициализировать новый модуль Go. Для этого выполните команду `go mod init` и назовите наш модуль `listener`.

```sh
go mod init listener
```

Теперь у нас есть базовая структура для нашего нового сервиса.

---

### Шаг 2: Установка необходимого пакета для работы с RabbitMQ

Хотя мы ещё не запустили RabbitMQ, нам нужно установить драйвер для работы с ним. Для этого воспользуемся командой `go get`, чтобы получить нужный пакет с GitHub. Введите следующую команду:

```sh
go get github.com/rabbitmq/amqp091-go
```

Эта команда добавит необходимый пакет в файл `go.mod`, и мы сможем работать с RabbitMQ, когда он будет настроен.

---

### Шаг 3: Создание основного файла сервиса

Внутри папки `listener-service` создадим файл `main.go`. В этом сервисе нам не потребуется создавать папку `cmd`, так как он не будет работать в качестве API или веб-сервиса. Это будет простой слушатель. Поэтому мы создадим файл `main.go` прямо в корневом каталоге папки сервиса.

Начнем с определения основной функции:

```go
package main

func main() {
	// try to connect to rabbitmq

	// start listening for messages

	// create consumer

	// watch the queue and consume events
}
```

Здесь у нас есть основная функция `main`, внутри которой мы пока что разместили комментарии, описывающие дальнейшие шаги.

---

### Шаг 4: Планирование логики Listener-сервиса

Основная логика Listener-сервиса будет следующей:

1. **Подключение к RabbitMQ**: Первым шагом будет попытка установить соединение с RabbitMQ. Хотя мы ещё не запустили его, это будет наша первая задача после его настройки.
  
2. **Прослушивание сообщений**: После успешного подключения мы начнем прослушивать сообщения из очереди. Важно отметить, что наше приложение не будет периодически подключаться к очереди для проверки новых сообщений. Вместо этого очередь будет автоматически отправлять сообщения слушателю.
  
3. **Создание Consumer-а**: Следующий шаг — это создание потребителя (Consumer), который будет получать сообщения из очереди. Мы будем слушать эту очередь с помощью Consumer-а.
  
4. **Обработка событий из очереди**: Когда Consumer получит сообщение из очереди, мы выполним необходимые действия в зависимости от типа события.

Эти шаги составляют основную логику нашего Listener-сервиса.

---

### Заключение: Подготовка к подключению RabbitMQ

Первым шагом в реализации Listener-сервиса будет попытка подключения к RabbitMQ. Но перед этим нам нужно добавить RabbitMQ в файл `docker-compose.yml`, чтобы запустить его. Мы займемся этим в следующей лекции.

---
