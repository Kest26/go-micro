## Обновление фронтенда для отправки данных логгера через брокер

### Добавление кнопки на тестовой странице

Для того чтобы протестировать логирование данных через наш микросервис брокера, необходимо обновить фронтенд-приложение `front-end`. Перейдём в проект фронтенда `front-end`, откроем папку `cmd`, затем папку `web`, и откроем файл `templates/test.page.gohtml`.

Первым шагом добавим новую кнопку на страницу. Продублируем строку с кнопкой для тестирования аутентификации (строка 10). Зададим новой кнопке ID `logBtn` и изменим отображаемый текст на "Test Log".

### Добавление логики для обработки нажатия кнопки

Теперь нужно получить ссылку на новую кнопку в нашем JavaScript-коде. В секции JavaScript на строке 38 продублируем строку с переменной для кнопки аутентификации и назовём новую переменную `logBtn`, присвоив ей ссылку на элемент с ID `logBtn`.

Далее добавим слушатель событий для новой кнопки. Для этого добавим следующий код:

```javascript
logBtn.addEventListener("click", function () {
    const payload = {
        action: "log",
        log: {
            name: "event",
            data: "Some kind of data",
        },
    };

    const headers = new Headers();
    headers.append("Content-Type", "application/json");

    const body = {
        method: "POST",
        body: JSON.stringify(payload),
        headers: headers,
    };

    fetch("http://localhost:8080/handle", body)
        .then((response) => response.json())
        .then((data) => {
            sent.innerHTML = JSON.stringify(payload, undefined, 4);
            received.innerHTML = JSON.stringify(data, undefined, 4);
            if (data.error) {
                output.innerHTML += `<br><strong>Error:</strong> ${data.message}`;
            } else {
                output.innerHTML += `<br><strong>Response from broker service</strong>: ${data.message}`;
            }
        })
        .catch((error) => {
            output.innerHTML += "<br><br>Error: " + error;
        });
});
```

Этот код добавляет прослушивание клика на новую кнопку, отправляет запрос с логом на брокер и выводит полученный ответ на экран.

### Настройка отправки данных

Логика обработки клика практически идентична обработке клика на кнопку аутентификации. Мы формируем JSON-пейлоад с действием "log" и полями для имени события и данных. Затем создаём объект заголовков и тело запроса, в котором содержится наш JSON.

Используем функцию `fetch`, чтобы отправить POST-запрос на URL `http://localhost:8080/handle`. После получения ответа мы выводим его в HTML-элементы на странице.

### Заключение

Теперь у нас есть кнопка для тестирования логгирования данных через брокер. В следующей лекции мы добавим логику в сервис аутентификации, чтобы при успешной аутентификации автоматически отправлять лог-запись в наш сервис логирования.
